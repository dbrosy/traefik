http:
  routers:
    traefik:
      rule: Host(`${TRAEFIK_DOMAIN}`)
      entrypoints: http
      service: api@internal
      tls:
        certresolver: letsencrypt
      middlewares: authtraefik
    catch-all:
      rule: hostregexp(`{host:.+}`)
      entrypoints: http
      middlewares: redirect-to-https
  middlewares:
    authtraefik:
      basicAuth:
        users:
          - ${TRAEFIK_USER}:${TRAEFIK_PASSWORD_HASH}
    redirect-to-https:
      redirectscheme:
        scheme: https
    test-ipwhitelist:
      ipwhitelist:
        sourcerange:
          - "${TRAEFIK_IP_WHITELIST}"
    
